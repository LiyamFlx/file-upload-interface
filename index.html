<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InsightWave Engagement Analysis</title>
    <style>
        /* Basic CSS for styling */
        body {
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        .container {
            max-width: 600px;
            padding: 20px;
            background-color: #1f1f1f;
            border-radius: 8px;
            text-align: center;
        }
        h1, h2 {
            color: #f0a500;
        }
        button {
            padding: 10px 20px;
            margin: 10px;
            background-color: #f0a500;
            border: none;
            border-radius: 5px;
            color: #1f1f1f;
            font-weight: bold;
            cursor: pointer;
        }
        button:hover {
            background-color: #d48800;
        }
        #fileInput, #progressBar, canvas, .tooltip {
            width: 100%;
        }
        #progressBar {
            height: 20px;
            background-color: #333;
            border-radius: 5px;
            margin: 20px 0;
        }
        #progressBar div {
            height: 100%;
            width: 0;
            background-color: #f0a500;
            border-radius: 5px;
        }
        .tooltip {
            position: absolute;
            background-color: #333;
            color: #f0f0f0;
            padding: 5px;
            border-radius: 4px;
            font-size: 12px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Start Screen -->
        <div id="startScreen">
            <h1>Welcome to InsightWave</h1>
            <p>Analyze your audio content for engagement and sentiment insights.</p>
            <button onclick="showScreen('uploadScreen')">Start Analysis</button>
        </div>

        <!-- Upload File Screen -->
        <div id="uploadScreen" style="display: none;">
            <h2>Upload Audio File</h2>
            <input type="file" id="fileInput" accept=".mp3, .wav, .mp4" onchange="enableAnalysis()">
            <button id="analyzeButton" onclick="startAnalysis()" disabled>Analyze</button>
        </div>

        <!-- Analysis Screen -->
        <div id="analysisScreen" style="display: none;">
            <h2>Real-Time Analysis</h2>
            <p>Analyzing volume, pitch, sentiment, and more...</p>
            <div id="progressBar"><div></div></div>
            <canvas id="engagementChart"></canvas>
            <button onclick="showScreen('uploadScreen')">Back</button>
            <button onclick="showScreen('resultsScreen')">View Results</button>
        </div>

        <!-- Results Screen -->
        <div id="resultsScreen" style="display: none;">
            <h2>Analysis Results</h2>
            <p>Key Insights</p>
            <ul>
                <li>Overall Engagement Score: <span id="overallScore">-</span>/10</li>
                <li>Peak Engagement Times: Segment 1, Segment 3</li>
                <li>Improvement Tips: Increase interaction during pauses</li>
            </ul>
            <button onclick="downloadReport()">Download Report</button>
            <button onclick="showScreen('startScreen')">New Analysis</button>
        </div>
    </div>

    <!-- Tooltip -->
    <div class="tooltip" id="tooltip"></div>

    <!-- Include Chart.js for graphing -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Include jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>

    <script>
        // Initialize global variables
        let engagementData = [];
        let sentimentData = [];
        let labels = [];
        let chart;

        // Function to navigate between screens
        function showScreen(screenId) {
            document.querySelectorAll('.container > div').forEach(div => div.style.display = 'none');
            document.getElementById(screenId).style.display = 'block';
        }

        // Enable analysis button when a file is uploaded
        function enableAnalysis() {
            document.getElementById('analyzeButton').disabled = false;
        }

        // Initialize the chart for real-time analysis
        function initChart() {
            const ctx = document.getElementById('engagementChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Engagement Score',
                            borderColor: 'rgba(240, 165, 0, 1)',
                            backgroundColor: 'rgba(240, 165, 0, 0.2)',
                            data: engagementData,
                            fill: true,
                        },
                        {
                            label: 'Sentiment Score',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            data: sentimentData,
                            fill: true,
                        }
                    ]
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        tooltip: {
                            enabled: false,
                            external: customTooltip
                        }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 'Time (s)' }
                        },
                        y: {
                            title: { display: true, text: 'Score' }
                        }
                    }
                }
            });
        }

        // Custom tooltip for interactive insights
        function customTooltip(context) {
            const tooltipEl = document.getElementById('tooltip');
            const tooltipModel = context.tooltip;
            if (tooltipModel.opacity === 0) {
                tooltipEl.style.display = 'none';
                return;
            }
            tooltipEl.innerHTML = `${tooltipModel.title}: ${tooltipModel.body[0].lines}`;
            tooltipEl.style.left = context.chart.canvas.offsetLeft + tooltipModel.caretX + 'px';
            tooltipEl.style.top = context.chart.canvas.offsetTop + tooltipModel.caretY + 'px';
            tooltipEl.style.display = 'block';
        }

        // Simulate real-time analysis
        function startAnalysis() {
            showScreen('analysisScreen');
            initChart();
            const progressBar = document.getElementById('progressBar').firstElementChild;
            let time = 0;
            const interval = setInterval(() => {
                time += 1;
                labels.push(time);
                engagementData.push(Math.random() * 10);
                sentimentData.push(Math.random() * 10);
                progressBar.style.width = (time / 30) * 100 + '%'; // Assuming 30 seconds total
                chart.update();
                if (time === 30) {
                    clearInterval(interval);
                }
            }, 1000);
        }

        // Download the report as PDF
        function downloadReport() {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();
            pdf.setFontSize(18);
            pdf.text("InsightWave Engagement
